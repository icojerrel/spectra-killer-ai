# NQ Stats Configuration
# Based on 10-20 years of historical data analysis (2004-2025)

# Standard Deviation Values (%)
# These are instrument-specific and should be calibrated via backtesting
# Default values are for NQ (Nasdaq-100 E-Mini)
sdev_values:
  monthly: 4.5      # Monthly standard deviation %
  weekly: 2.1       # Weekly standard deviation %
  daily: 1.376      # Daily standard deviation % (most important)
  hourly: 0.34      # Hourly standard deviation %

# Probability Thresholds
probability_thresholds:
  high: 0.75        # >= 75% is high probability
  medium: 0.51      # 51-75% is medium probability
  low: 0.50         # < 50% is low probability

# Trading Hours (EST/EDT)
trading_hours:
  rth_start: "09:30"        # Regular Trading Hours start
  rth_end: "16:00"          # Regular Trading Hours end
  ib_start: "09:30"         # Initial Balance start
  ib_end: "10:30"           # Initial Balance end
  noon_pivot: "12:00"       # Noon curve pivot
  am_start: "08:00"         # AM session start (for Noon Curve)
  pm_end: "16:00"           # PM session end

# Session Definitions (EST/EDT)
sessions:
  asian:
    start: "20:00"          # 8pm previous day
    end: "02:00"            # 2am current day
    liquidity: 0.6
    volatility: 0.7
  london:
    start: "02:00"          # 2am
    end: "08:00"            # 8am
    liquidity: 1.3
    volatility: 1.4
  new_york:
    start: "08:00"          # 8am
    end: "16:00"            # 4pm
    liquidity: 1.4
    volatility: 1.5

# Hour Segment Probabilities
# Each hour divided into three 20-minute segments
hour_segments:
  segment_1:  # 0-20 minutes
    retracement_probability: 0.89
    type: "wick_formation"
    trading_recommendation: "HIGH_PROBABILITY_RETRACEMENT"
  segment_2:  # 20-40 minutes
    retracement_probability: 0.47
    type: "expansion"
    trading_recommendation: "MOMENTUM_TRADING"
  segment_3:  # 40-60 minutes
    retracement_probability: 0.35
    type: "wick_formation"
    trading_recommendation: "PREPARE_NEXT_HOUR"

# RTH Break Probabilities
rth_breaks:
  opened_outside_prth_probability: 0.8329   # 83.29% won't break opposite side
  opened_inside_prth_probability: 0.7266    # 72.66% will break at least one side
  confidence_threshold: 0.75                # High confidence threshold

# Continuation Probabilities
continuation:
  hour_9am:
    ny_session_probability: 0.70            # 70% NY session continuation
    full_session_probability: 0.67          # 67% full session continuation
    confidence: "HIGH"
  hour_6pm:
    full_session_probability: 0.59          # 59% weak edge
    confidence: "LOW"

# Morning Judas Probabilities
morning_judas:
  up_judas:
    continuation_probability: 0.64          # 64% continuation to 10am
    reversal_probability: 0.36              # 36% reversal
    continuation_to_noon_probability: 0.68  # 68% continuation to noon
  down_judas:
    continuation_probability: 0.70          # 70% continuation to 10am
    reversal_probability: 0.30              # 30% reversal
    continuation_to_noon_probability: 0.59  # 59% continuation to noon

# Initial Balance Break Probabilities
initial_balance:
  break_by_eod_probability: 0.96           # 96% break by end of day
  break_by_noon_probability: 0.83          # 83% break by noon
  upper_half_close:
    high_break_probability: 0.81           # 81% IB high breaks
    direction: "BULLISH"
  lower_half_close:
    low_break_probability: 0.74            # 74% IB low breaks
    direction: "BEARISH"

# Noon Curve Probabilities
noon_curve:
  opposite_sides_probability: 0.743        # 74.3% high/low on opposite sides
  same_side_probability: 0.257             # 25.7% both on same side
  q1_sets_extreme_probability: 0.67        # 66-68% Q1 (8-10am) sets AM extreme

# ALN Session Pattern Probabilities
aln_sessions:
  london_engulfs_asia:
    ny_breaks_london_probability: 0.98     # 98% NY breaks at least one side
    ny_engulfs_all_probability: 0.43       # 43% NY engulfs entire overnight
    first_break_reduces_opposite: 0.50     # ~50% reduction if opposite taken first
    confidence: "VERY_HIGH"

  asia_engulfs_london:  # Rare - 7%
    ny_breaks_london_probability: 0.95     # 95%
    ny_breaks_asia_probability: 0.91       # 91%
    ny_engulfs_all_probability: 0.39       # 39%
    confidence: "HIGH"

  london_partial_up:
    london_high_break_probability: 0.79    # 79%
    london_low_break_probability: 0.63     # 63%
    asia_low_break_probability: 0.51       # 51%
    opposite_first_reduces_to: 0.49        # ~48-50%
    confidence: "HIGH"

  london_partial_down:
    london_low_break_probability: 0.73     # 73%
    london_high_break_probability: 0.66    # 66%
    asia_high_break_probability: 0.54      # 54%
    opposite_first_reduces_to: 0.42        # ~41-43%
    confidence: "HIGH"

# Signal Generation Settings
signals:
  min_confidence: 0.50                     # Minimum confidence for signal generation
  confluence_bonus: 0.10                   # Bonus per additional confirming signal
  max_confidence: 0.95                     # Maximum confidence cap

# Position Sizing Based on Confluence
position_sizing:
  single_signal: 1.0                       # Base position (1x)
  two_signals: 1.25                        # 1.25x position
  three_signals: 1.5                       # 1.5x position
  four_plus_signals: 2.0                   # 2x position (maximum)

# Risk Management Integration
risk_management:
  sdev_stop_loss_multiplier: 1.5           # Place stops at ±1.5 SDEV
  sdev_take_profit_multiplier: 1.0         # Take profits at ±1.0 SDEV
  reduce_size_at_extremes: true            # Reduce size beyond ±1.5 SDEV

  # Time-based risk adjustments
  hour_segment_1_multiplier: 0.8           # Reduce size first 20 min (wick zone)
  hour_segment_2_multiplier: 1.2           # Increase size middle segment (expansion)
  hour_segment_3_multiplier: 0.9           # Slightly reduce last segment

  # 9am hour special handling
  avoid_9am_hour_pre_open: true            # Wait for 9:30am open
  reduce_size_9am_hour: 0.5                # 50% size reduction during 9-9:30am

# Instrument-Specific Calibration
# For adapting NQ Stats to other instruments (XAUUSD, ES, etc.)
calibration:
  instrument: "NQ"                         # Current instrument
  calibration_period_years: 20             # Years of data used for calibration
  recalibration_frequency_days: 90         # Recalibrate every 90 days
  min_sample_size: 1000                    # Minimum trades for statistical significance

  # Adjustment factors for different instruments
  volatility_adjustment: 1.0               # Multiply SDEV by this for different instruments
  liquidity_adjustment: 1.0                # Adjust probabilities based on liquidity

# Feature Flags
features:
  enable_sdev_analysis: true
  enable_hour_stats: true
  enable_rth_breaks: true
  enable_9am_continuation: true
  enable_morning_judas: true
  enable_initial_balance: true
  enable_noon_curve: true
  enable_aln_sessions: true

  # Advanced features
  enable_multi_timeframe_confluence: true
  enable_dynamic_probability_adjustment: true
  enable_backtesting_mode: false

# Logging and Monitoring
logging:
  log_level: "INFO"
  log_all_signals: true
  log_probability_calculations: false      # Set to true for debugging
  log_pattern_detection: true

# Performance Tracking
tracking:
  track_signal_performance: true
  track_probability_accuracy: true
  min_tracking_period_days: 30
  generate_performance_reports: true

# Dashboard Integration
dashboard:
  show_sdev_levels: true
  show_ib_levels: true
  show_session_patterns: true
  show_probability_heatmap: true
  show_confluence_score: true
  update_frequency_seconds: 5

# Backtesting Configuration
backtesting:
  start_date: "2020-01-01"
  end_date: "2025-01-01"
  instruments: ["NQ", "ES", "XAUUSD"]
  validate_probabilities: true
  confidence_intervals: [0.68, 0.84, 0.95]  # 1σ, 1.5σ, 2σ

# Notes
# - All probabilities based on 10-20 years of NQ historical data
# - Probabilities should be recalibrated for different instruments
# - Source: nqstats.com (2004-2025)
# - Implementation: Spectra Killer AI v2.0
